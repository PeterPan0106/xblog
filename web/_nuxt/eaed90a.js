(window.webpackJsonp=window.webpackJsonp||[]).push([[36,18,34],{1254:function(t,e,n){"use strict";n(913)},1255:function(t,e,n){var o=n(8)(!1);o.push([t.i,".option-card .el-card__header{padding:0!important}.option-card .el-divider--horizontal{margin:10px 0!important}",""]),t.exports=o},1256:function(t,e,n){"use strict";n(914)},1257:function(t,e,n){var o=n(8)(!1);o.push([t.i,".post-tree[data-v-8018fedc]{max-height:500px;overflow-y:auto}.card-head[data-v-8018fedc]{padding:18px 20px;color:#fff;font-size:16px}.option-card[data-v-8018fedc]{margin-bottom:10px}.add_chapter[data-v-8018fedc]{margin-top:10px;width:100%;display:flex;justify-content:center}.contextmenu[data-v-8018fedc]{position:fixed;min-width:-webkit-min-content;min-width:-moz-min-content;min-width:min-content;z-index:1900;border:1px solid #d4d4d5;line-height:1.4285em;max-width:150px;background:#fff;font-weight:400;font-style:normal;color:rgba(0,0,0,.87);border-radius:.28571429rem;box-shadow:0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.15)}.contextmenu div[data-v-8018fedc]{position:relative;vertical-align:middle;line-height:1;-webkit-tap-highlight-color:transparent;padding:10px 15px;color:rgba(0,0,0,.87);font-size:14px;cursor:pointer}.contextmenu div[data-v-8018fedc]:hover{background:#eee}",""]),t.exports=o},1307:function(t,e,n){"use strict";n.r(e);n(33),n(24),n(27),n(45),n(46);var o=n(12),c=(n(804),n(17),n(117),n(118),n(805)),r=n.n(c),d=n(13),l=n(707),h=n(651);function f(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}var m={components:{PostEdit:l.default},layout:"admin",mixins:[h.default],data:function(){return{left:0,top:0,visible:!1,clickRightItem:{},clickRightNode:{},id:0,doc:{content:"",md:""},flag:!1,saveStatus:!1}},computed:function(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?f(Object(source),!0).forEach((function(e){Object(o.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):f(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}({},Object(d.b)("admin-posts",["docList","docContent"])),watch:{visible:function(t){t?document.body.addEventListener("click",this.closeMenu):document.body.removeEventListener("click",this.closeMenu)},doc:{deep:!0,handler:function(){this.flag?(this.saveStatus=!1,this.debouncedAutoSave()):this.flag=!0}}},created:function(){this.debouncedAutoSave=r.a.debounce(this.saveChapter,1e3)},mounted:function(){this.$store.dispatch("admin-posts/getDocs")},methods:{nodeRightClick:function(t,data,e,n){this.clickRightItem=data,this.clickRightNode=e,this.left=t.clientX,this.top=t.clientY,this.visible=!0},closeMenu:function(){this.visible=!1},addNewChapter:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.$prompt("请输入标题","提示",{closeOnClickModal:!1,confirmButtonText:"确定",cancelButtonText:"取消"}).then((function(o){var c=o.value;e.$store.dispatch("admin-posts/addDocs",{parent:t,title:c}).then((function(data){var t={id:data.id,label:c,children:[]};null!==n?(n.children||e.$set(n,"children",[]),n.children.push(t)):e.$store.commit("admin-posts/docListPush",t)})).catch((function(t){e.$message.error(t)}))})).catch((function(){}))},updateChapter:function(data){return this.$store.dispatch("admin-posts/updatePost",data)},delChapter:function(data,t){var e=this;this.$confirm("删除该文档(该文档下所有子文档都会消失)?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.updateChapter({id:data.id,data:{delete:"true"}}).then((function(){var n=t.parent,o=n.data.children||n.data,c=o.findIndex((function(t){return t.id===data.id}));o.splice(c,1),e.$message.success("删除成功")})).catch((function(){e.$message.error("删除失败")}))})).catch((function(){}))},changeChapterTitle:function(data){var t=this;this.$prompt("新标题","提示",{closeOnClickModal:!1,confirmButtonText:"确定",cancelButtonText:"取消",inputValue:data.label}).then((function(e){var n=e.value;t.updateChapter({id:data.id,data:{title:n}}).then((function(){data.label=n})).catch((function(e){t.$message.error(e)}))})).catch((function(){}))},nodeDrop:function(t,e,n){var o=this,c=t.data.id,r=e.data.id;"inner"!==n&&void 0===(r=e.parent.data.id)&&(r=0),this.updateChapter({id:c,data:{parent:r.toString()}}).catch((function(){o.$store.dispatch("admin-posts/getDocs")}))},nodeClick:function(data){var t=this;this.id=data.id,this.$store.dispatch("admin-posts/getDocsContent",data.id).then((function(data){t.$refs.edit.setContent(data.md?data.md:data.content)})).catch((function(e){t.$message.error(e)}))},saveChapter:function(){var t=this;0!==this.id?this.updateChapter({id:this.id,data:{html:this.doc.content,md:this.doc.md}}).then((function(){t.saveStatus=!0})).catch((function(){t.$message.error("保存失败")})):this.$message.error("请选择要编辑文档!")}}},v=(n(1254),n(1256),n(5)),component=Object(v.a)(m,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("el-row",{attrs:{gutter:20}},[n("el-col",{attrs:{xs:24,sm:9,md:4}},[n("el-card",{staticClass:"option-card",attrs:{shadow:"hover"}},[n("div",{staticClass:"card-head",staticStyle:{background:"#996600"},attrs:{slot:"header"},slot:"header"},[n("font-awesome-icon",{attrs:{icon:"list"}}),t._v(" "),n("span",[t._v("文档目录")]),t._v(" "),n("span",{directives:[{name:"show",rawName:"v-show",value:t.saveStatus,expression:"saveStatus"}],staticStyle:{"font-size":"12px"}},[n("i",{staticClass:"el-icon-circle-check"}),t._v("已自动保存")])],1),t._v(" "),n("el-tree",{ref:"tree",staticClass:"post-tree",attrs:{data:t.docList,draggable:"","highlight-current":!0,"expand-on-click-node":!1},on:{"node-contextmenu":t.nodeRightClick,"node-click":t.nodeClick,"node-drop":t.nodeDrop}}),t._v(" "),n("div",{staticClass:"add_chapter"},[n("el-button",{attrs:{plain:""},on:{click:function(e){return t.addNewChapter(0)}}},[t._v("\n            新增章节\n          ")])],1)],1)],1),t._v(" "),n("el-col",{attrs:{xs:24,sm:15,md:20}},[n("post-edit",{ref:"edit",attrs:{html:t.doc.content,md:t.doc.md},on:{"update:html":function(e){return t.$set(t.doc,"content",e)},"update:md":function(e){return t.$set(t.doc,"md",e)}}})],1)],1),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.visible,expression:"visible"}],staticClass:"contextmenu",style:{left:t.left+"px",top:t.top+"px"}},[n("div",{on:{click:function(e){return t.addNewChapter(t.clickRightItem.id,t.clickRightItem)}}},[t._v("\n      新建子章节\n    ")]),t._v(" "),n("div",{on:{click:function(e){return t.changeChapterTitle(t.clickRightItem)}}},[t._v("\n      编辑\n    ")]),t._v(" "),n("div",{on:{click:function(e){return t.delChapter(t.clickRightItem,t.clickRightNode)}}},[t._v("\n      删除\n    ")])])],1)}),[],!1,null,"8018fedc",null);e.default=component.exports},651:function(t,e,n){"use strict";n.r(e),e.default={head:function(){return{title:"XBlog后台管理系统"}}}},669:function(t,e,n){var content=n(696);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(9).default)("57bc5cd6",content,!0,{sourceMap:!1})},695:function(t,e,n){"use strict";n(669)},696:function(t,e,n){var o=n(8)(!1);o.push([t.i,".vditor-tooltipped img{width:20px;padding:2px;margin-top:-5px}.vditor-tooltipped img:hover{border:1px solid #ddd;background:#eee}",""]),t.exports=o},707:function(t,e,n){"use strict";n.r(e);n(119),n(95);var o,c,r=n(97),d=n.n(r),l={name:"blueBackground",tip:"蓝色背景",click:function(){o.updateValue("[info]".concat(o.getSelection(),"[/info]"))},icon:'<img alt src="/static/images/buttons/info.png">'},h={name:"dangerBackground",tip:"红色背景",click:function(){o.updateValue("[danger]".concat(o.getSelection(),"[/danger]"))},icon:'<img alt src="/static/images/buttons/danger.png">'},f={name:"greenBackground",tip:"绿色背景",click:function(){o.updateValue("[success]".concat(o.getSelection(),"[/success]"))},icon:'<img alt  src="/static/images/buttons/success.png">'},m={name:"infoBox",tip:"蓝色标题栏",click:function(){o.updateValue('[infobox title="标题"]'.concat(o.getSelection(),"[/infobox]"))},icon:'<img alt  src="/static/images/buttons/infobox.png">'},v={name:"dangerBox",tip:"红色标题栏",click:function(){o.updateValue('[dangerbox title="标题"]'.concat(o.getSelection(),"[/dangerbox]"))},icon:'<img alt  src="/static/images/buttons/dangerbox.png">'},x={name:"successBox",tip:"绿色标题栏",click:function(){o.updateValue('[successbox title="标题"]'.concat(o.getSelection(),"[/successbox]"))},icon:'<img alt  src="/static/images/buttons/successbox.png">'},k={name:"block",tip:"代码块",click:function(){o.updateValue("[block]".concat(o.getSelection(),"[/block]"))},icon:'<img alt  src="/static/images/buttons/codeblock.png">'},w={name:"collSpan",tip:"展开收缩",click:function(){o.updateValue('[collapse title="标题"]'.concat(o.getSelection(),"[/collapse]"))},icon:'<img alt  src="/static/images/buttons/accordion.png">'},y={name:"music",tip:"网易云音乐",click:function(){o.updateValue('[music autoplay="0"]'.concat(o.getSelection(),"[/music]"))},icon:'<img alt  src="/static/images/buttons/music.png">'},C={name:"bilibili",tip:"哔哩哔哩",click:function(){o.updateValue('[bilibili cid="" page="1"]'.concat(o.getSelection(),"[/bilibili]"))},icon:'<img alt  src="/static/images/buttons/bilibili.png">'},_={name:"yBtn",tip:"云盘下载",click:function(){o.updateValue("[ypbtn]".concat(o.getSelection(),"[/ypbtn]"))},icon:'<img alt  src="/static/images/buttons/ypbtn.png">'},$={name:"PostEdit",props:{html:{type:String,default:""},md:{type:String,default:""}},data:function(){return c=this,{option:{height:740,resize:{enable:!0},tab:"    ",typewriterMode:!0,placeholder:"随便写点什么吧~",counter:{enable:!0,type:"text"},mode:"ir",icon:"material",toolbar:["undo","redo","|","bold","italic","strike","quote","line","|","headings","list","ordered-list","outdent","indent","|","upload","link","code","inline-code","check","table","emoji","|","both","edit-mode","fullscreen","preview","outline","export","|",l,h,f,m,v,x,k,w,y,C,_],cache:{enable:!1},input:function(){c.$emit("update:html",o.getHTML()),c.$emit("update:md",o.getValue())},upload:{accept:"image/*",handler:function(t){var data=new FormData;data.append("file",t[0]),c.$store.dispatch("admin-file/uploadImage",data).then((function(data){o.focus(),o.updateValue("![](".concat(data.url,")"))}))},multiple:!1},preview:{delay:0}}}},watch:{html:function(content){var t=this;try{setTimeout((function(){1===o.getValue().length&&null!==o&&""!==t.html&&o.setValue(t.md?t.md:t.html)}),200)}catch(t){this.$message.error("加载出现问题，请尝试关闭并重新进入！")}}},mounted:function(){var t=this;this.init(),setTimeout((function(){d()(".vditor-reset").on("paste",(function(e){var n=(e.clipboardData||e.originalEvent.clipboardData).items;if(0!==n.length&&n[0].type.includes("image")){var c=n[0].getAsFile(),data=new FormData;data.append("file",c),t.$store.dispatch("admin-file/uploadImage",data).then((function(data){o.focus(),o.updateValue("![](".concat(data.url,")"))}))}}))}),500)},methods:{setContent:function(content){o.setValue(content)},init:function(){this.Vditor=n(759),n(760),o=new this.Vditor("editor",this.option)}}},S=(n(695),n(5)),component=Object(S.a)($,(function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("div",{staticClass:"editor",attrs:{id:"editor"}})])}],!1,null,null,null);e.default=component.exports},804:function(t,e,n){"use strict";var o=n(7),c=n(154)(6),r="findIndex",d=!0;r in[]&&Array(1)[r]((function(){d=!1})),o(o.P+o.F*d,"Array",{findIndex:function(t){return c(this,t,arguments.length>1?arguments[1]:void 0)}}),n(153)(r)},913:function(t,e,n){var content=n(1255);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(9).default)("8c10ddba",content,!0,{sourceMap:!1})},914:function(t,e,n){var content=n(1257);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(9).default)("c555310e",content,!0,{sourceMap:!1})}}]);