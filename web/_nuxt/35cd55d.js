(window.webpackJsonp=window.webpackJsonp||[]).push([[6,34],{1304:function(e,t,n){"use strict";n(938)},1305:function(e,t,n){var r=n(8)(!1);r.push([e.i,"img.friend-avatar[data-v-e8631a9e]{width:45px;height:45px;border-radius:50%}.vxe-button+.vxe-button[data-v-e8631a9e]{margin-left:0!important}",""]),e.exports=r},1338:function(e,t,n){"use strict";n.r(t);n(67),n(47),n(119),n(95);var r=n(652),o=n(68),c=[{label:"已通过",value:1},{label:"已拒绝",value:0}],l={layout:"admin",mixins:[r.default],data:function(){var e=this;return{selects:"",tableProxy:{ajax:{query:function(e){var t=e.page,form=e.form;return Object(o.f)({url:"/friends",type:"get",data:{page:t.currentPage,page_size:t.pageSize,search_type:form.search_type,search_key:form.search_key}})},delete:function(t){return e.updateFriends(e.selects,null,!0)}}},tableForm:{items:[{field:"search_type",title:"搜索类型",itemRender:{name:"$select",options:[{label:"友链名称",value:"name"},{label:"友链地址",value:"url"},{label:"友链邮箱",value:"email"},{label:"友链描述",value:"description"},{label:"友链状态",value:"status"}]}},{field:"search_key",visibleMethod:function(e){return"status"!==e.data.search_type},title:"关键词",itemRender:{name:"$input",attrs:{placeholder:"请输入关键词"}}},{field:"search_key",visibleMethod:function(e){return"status"===e.data.search_type},title:"友链状态",itemRender:{name:"$select",options:c}},{itemRender:{name:"$button",props:{content:"查询",type:"submit",status:"primary"}}},{itemRender:{name:"$button",props:{content:"重置",type:"reset"}}}]},tableToolbar:{buttons:[{code:"insert_actived",name:"添加",icon:"fa fa-plus",status:"primary"},{code:"agree",name:"通过",icon:"fa fa-check",status:"success"},{code:"deny",name:"拒绝",icon:"fa fa-close",status:"warning"},{code:"delete",name:"删除选中",icon:"fa fa-trash",status:"danger"}],zoom:!0,custom:!0},editConfig:{trigger:"manual",mode:"row",autoClear:!1,icon:"none"},tableColumn:[{type:"checkbox",width:50},{field:"name",title:"友链名称",editRender:{name:"input"}},{field:"url",title:"友链地址",editRender:{name:"input"}},{field:"avatar",title:"友链头像",slots:{default:"avatar"},editRender:{name:"input"}},{field:"email",title:"友链邮箱",editRender:{name:"input"}},{field:"description",title:"友链描述",editRender:{name:"input"}},{field:"status",title:"友链状态",formatter:"formatReview",width:100,editRender:{name:"$select",options:c}},{title:"操作",slots:{default:"option"}}]}},methods:{toolbarClick:function(e){var code=e.code;e.button;switch(code){case"agree":this.updateFriends(this.selects,"1");break;case"deny":this.updateFriends(this.selects,"0")}},checkboxChangeEvent:function(data){var e=[];data.records.map((function(t){return e.push(t.id)})),this.selects=e.toString()},editRowEvent:function(e){this.$refs.grid.setActiveRow(e)},saveRowEvent:function(e){var t=this;this.$refs.grid.clearActived().then((function(){var data={name:e.name,url:e.url,avatar:e.avatar,description:e.description,email:e.email,status:0===e.status?"0":"1"};e.id.includes("row")?t.$store.dispatch("admin-plugins/pluginRequest",{url:"/friends",type:"post",data:data}).then((function(e){return t.updateData()})).catch((function(e){t.$message.error(e),t.updateData(!1)})):t.$store.dispatch("admin-plugins/pluginRequest",{url:"/friends/".concat(e.id),type:"put",data:data}).then((function(e){return t.updateData()})).catch((function(e){return t.$message.error(e)}))}))},updateData:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];e&&this.$message.success("更新成功"),this.$refs.grid.commitProxy("query")},updateFriends:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(""===e)this.$message.warning("请选择内容！");else{var data={status:t};r?this.$store.dispatch("admin-plugins/pluginRequest",{url:"/friends/".concat(e),type:"delete",data:null}).then((function(e){return n.updateData()})).catch((function(e){return n.$message.error(e)})):this.$store.dispatch("admin-plugins/pluginRequest",{url:"/friends/".concat(e),type:"put",data:data}).then((function(e){return n.updateData()})).catch((function(e){return n.$message.error(e)}))}},sendNotification:function(e){var t=this;this.$store.dispatch("admin-plugins/pluginRequest",{url:"/friends/".concat(e,"/notification"),type:"put",data:null}).then((function(e){return t.$message.success("已发布邮件通知")})).catch((function(e){return t.$message.error(e)}))}}},d=(n(1304),n(5)),component=Object(d.a)(l,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("vxe-grid",{ref:"grid",attrs:{border:"",resizable:"",height:"780","row-id":"id","pager-config":{pageSize:10},"proxy-config":e.tableProxy,"form-config":e.tableForm,"toolbar-config":e.tableToolbar,columns:e.tableColumn,"edit-config":e.editConfig},on:{"toolbar-button-click":e.toolbarClick,"checkbox-change":e.checkboxChangeEvent,"checkbox-all":e.checkboxChangeEvent},scopedSlots:e._u([{key:"avatar",fn:function(e){var t=e.row;return[n("div",{staticStyle:{"text-align":"center"}},[n("img",{staticClass:"friend-avatar",attrs:{src:t.avatar}})])]}},{key:"option",fn:function(t){var r=t.row;return[n("vxe-button",{attrs:{icon:"fa fa-envelope",title:"发布通过通知",circle:""},on:{click:function(t){return e.sendNotification(r.id)}}}),e._v(" "),e.$refs.grid.isActiveByRow(r)?n("vxe-button",{attrs:{icon:"fa fa-save",status:"primary",title:"保存",circle:""},on:{click:function(t){return e.saveRowEvent(r)}}}):n("vxe-button",{attrs:{icon:"fa fa-edit",title:"编辑",circle:""},on:{click:function(t){return e.editRowEvent(r)}}}),e._v(" "),r.status?n("vxe-button",{attrs:{icon:"fa fa-close",title:"拒绝",circle:""},on:{click:function(t){return e.updateFriends(r.id,"0")}}}):n("vxe-button",{attrs:{icon:"fa fa-check",title:"允许",circle:""},on:{click:function(t){return e.updateFriends(r.id,"1")}}}),e._v(" "),n("el-popconfirm",{attrs:{title:"确定要删除这条友链？"},on:{onConfirm:function(t){return e.updateFriends(r.id,null,!0)}}},[n("vxe-button",{attrs:{slot:"reference",icon:"fa fa-trash",title:"删除",circle:""},slot:"reference"})],1)]}}])})],1)}),[],!1,null,"e8631a9e",null);t.default=component.exports},652:function(e,t,n){"use strict";n.r(t),t.default={head:function(){return{title:"XBlog后台管理系统"}}}},938:function(e,t,n){var content=n(1305);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(9).default)("5e44b80d",content,!0,{sourceMap:!1})}}]);